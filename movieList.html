<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Movie List</title>
  <link rel="stylesheet" href="movieList.css">
</head>

<body>
  <header>
    <nav>
      <div class="logo">MovieRec</div>
      <ul>
        <li><a href="home.html">Home</a></li>
        <li><a href="movieList.html">Movie List</a></li>
      </ul>
    </nav>
  </header>
  <main>
    <section class="movie-list">
      <div class="centered-title">
        <h2>movieList</h2>
      </div>
      <div id="top-rated-movies" class="movies-container">
      </div>
    </section>
  </main>
  <script src="script.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      fetchTopRatedMovies();
    });

    async function fetchTopRatedMovies() {
      try {
        const API_KEY = "faa8c28c41bbd8a91fcf6bc695828f93";
        const API_URL = "https://api.themoviedb.org/3";
        const LANGUAGE = "ko-KR";
        const PAGES_TO_FETCH = 5;

        for (let page = 1; page <= PAGES_TO_FETCH; page++) {
          const response = await fetch(
            `${API_URL}/movie/top_rated?api_key=${API_KEY}&language=${LANGUAGE}&page=${page}`
          );
          const data = await response.json();
          displayMovies(data.results, "top-rated-movies");
        }
      } catch (error) {
        console.error("Error fetching top rated movie data:", error);
        alert("Failed to fetch top rated movies. Please try again later.");
      }
    }

    function displayMovies(movies, containerId) {
      const moviesContainer = document.getElementById(containerId);
      movies.forEach((movie) => {
        const movieCard = document.createElement("div");
        movieCard.classList.add("movie-card");
        movieCard.innerHTML = `
            <img src="https://image.tmdb.org/t/p/w500${movie.poster_path}" alt="${movie.title}">
            <h3>${movie.title}</h3>
            <p>평점: ${movie.vote_average}</p>
            <p>개봉일: ${movie.release_date}</p>
        `;
        moviesContainer.appendChild(movieCard);
      });
    }
  </script>
</body>

</html>